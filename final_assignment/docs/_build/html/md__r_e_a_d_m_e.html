<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RT_2_Assignent_1: Research Track 1: Final Assignment</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RT_2_Assignent_1
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">ROS Project Mobile Robot</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Research Track 1: Final Assignment </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr  />
<h1><a class="anchor" id="autotoc_md2"></a>
Outline</h1>
<ul>
<li>ROS Package Description<ul>
<li>What the Package Does</li>
<li>How the Nodes in the Package works<ul>
<li>User Interface</li>
<li>Position Server</li>
<li>MoveBase Client</li>
<li>Bug0</li>
<li>How the nodes communicate (Computational Graph)</li>
</ul>
</li>
<li>Possible improvements to the package</li>
</ul>
</li>
<li>How to Compile and launch the Package</li>
</ul>
<h1><a class="anchor" id="autotoc_md3"></a>
ROS Package Description</h1>
<h2><a class="anchor" id="autotoc_md4"></a>
What the Package Does</h2>
<p>This package provides a 3D environment with a mobile robot, and a number of robot control is implemented to navigate this environment. The major packages and nodes that are showcased in this package are the MoveBase path planning package, the slam gmapping package for mapping the environment, and the bug0 node for implementing the bug0 motion planning algorithm. A command-line user interface is provided for the user to select one of the following actions</p><ol type="1">
<li>Switch to Bug0 algo.</li>
<li>Select one of the possible positions.</li>
<li>Controll the Robot manually with keyboard.</li>
</ol>
<p>There are 6 location listed as a possible targets for the robot to navigate to and based on the action selected between 1 or 2 a location will be set as a target location for the mobile robot to navigate to. There are two path planning algorithms implemented in this package, MoveBase Action(Dijkstra) and Bug0. MoveBase is the default algorithm for action , the user gets to use the Bug0 Algorithm to navigate to the selected or chosen target just once and then it is set back to the default algorithm. The user also has the opportunity to make the mobile robot follow the external walls in the environment by runing the wall_follow_service_m.py node, Below shows a view of the behaviour of the mobile robot when action one is selected with the default path planning algorithm still set to MoveBase. </p><div align="center"> <img src="images/simulation.gif" alt="MoveBase Path Planning simulation" title="MoveBase Path Planning simulation" class="inline"/> </div><h2><a class="anchor" id="autotoc_md5"></a>
How the nodes in the package works</h2>
<p>A number of nodes work together to make this package work as prescribed, however, all this would not be possible without the custom service message that was created, so the description of the workings of the package would begin with the custom services that was created for the communication of the nodes.</p>
<h3><a class="anchor" id="autotoc_md6"></a>
Custom Services</h3>
<p>MoveBaseTarget and MoveBaseResult_</p>
<ul>
<li><b>MoveBaseTarget</b> is a service message that is used to send a request of the target position that should be reached by the robot to the movebase client. A boolean response is sent back to the user interface which is True when the robot is already at the new target that was sent and false otherwise. <div class="fragment"><div class="line">int8 cord_x # This is the requested coordinates sent to the movebase client </div>
<div class="line">int8 cord_y </div>
<div class="line">---</div>
<div class="line">bool status </div>
</div><!-- fragment --></li>
<li><b>MoveBaseResult</b> is a service message that is used to request a response when the robot had reached the target goal. <div class="fragment"><div class="line">string status</div>
<div class="line">---</div>
<div class="line">string status </div>
</div><!-- fragment --></li>
</ul>
<h3><a class="anchor" id="autotoc_md7"></a>
User Interface</h3>
<p>The user interface is a command-line interface that queries the user as to what action they want the system to perform from the list of actions provided. The user interface is what connects all the nodes together, a number of service clients are implemented to connect with each of the nodes to set the required action to active. Two variables were created to make the switch in control easy and straightforward, *__pick and state__*</p>
<p><b>pick</b> represents the value of the action that was selected by the user</p>
<p><b>state</b> represents the state of the system ie (<em>performing an action or prompting a user to enter an action</em>)</p>
<p>A variable <b>algo</b> was also implemented to make the switch between algorithm</p>
<h3><a class="anchor" id="autotoc_md8"></a>
Position Server</h3>
<p>The position server is a server that accept a request for target position and then selects one of the 6 possible location from the list and sends the selected position as a response. </p><div class="fragment"><div class="line">TARGET_POSE = [(-4, -3), (-4, 2), (-4, 7), (5, -7), (5, -3), (5, 1)]</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md9"></a>
MoveBase Client</h3>
<p>The move base client is a node that accepts a target goal from the user interface and then sends the goal to the MoveBase server. It receives feedback of the current position from the movebase server and uses it to determine the distance to the target and then prints the output of this information on the screen. The move base client also monitors the movebase server to see if the goal has been succeded so as to send a response of <b>Target Reached</b> to the user interface and unblock the user interface. </p><div class="fragment"><div class="line">if (client.get_state() == GoalStatus.SUCCEEDED):</div>
<div class="line">    print(&quot;\nTarget Reached !!!\n&quot;)</div>
<div class="line">    state = 0</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md10"></a>
Bug0</h3>
<p>The bug0 path planning algorithm is an algorithm that uses two mechanisms, go straight to point and follow the wall. The algorithm</p><ol type="1">
<li>sets a straight path to the goal,</li>
<li>moves the robot towards the goal through that path,</li>
<li>if an obstacle is detected, follow the obstacle till the path to the goal is clear again</li>
<li>go straight to the goal.</li>
</ol>
<p>For this algorithm, two nodes were implemented, go_to_point node and wall_follow node. a service message is used to connect the two nodes to the bug0 node. Based on the stage of the algorithm the state is at, the bug0 node either sets</p><ul>
<li>the go_to_point node to active and wall_follow to not active</li>
<li>the go_to_point node to not active and wall_follow to active</li>
<li>the go_to_point node and the wall follow node to not active.</li>
</ul>
<div class="fragment"><div class="line">if state_ == 0:</div>
<div class="line">    resp = srv_client_go_to_point_(True)</div>
<div class="line">    resp = srv_client_wall_follower_(False)</div>
<div class="line">if state_ == 1:</div>
<div class="line">    resp = srv_client_go_to_point_(False)</div>
<div class="line">    resp = srv_client_wall_follower_(True)</div>
<div class="line">if state_ == 2:</div>
<div class="line">    resp = srv_client_go_to_point_(False)</div>
<div class="line">    resp = srv_client_wall_follower_(False)</div>
<div class="line">    twist_msg = Twist()</div>
<div class="line">    twist_msg.linear.x = 0</div>
<div class="line">    twist_msg.angular.z = 0</div>
<div class="line">    pub.publish(twist_msg)</div>
<div class="line">    state_ = 4</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md11"></a>
How the nodes communicates</h3>
<p>Below is an rqt graph that shows the communication between the nodes that has just been described.</p>
<p><img src="https://user-images.githubusercontent.com/105802251/169653015-c56aa7a5-9449-4293-87c5-cc5d37322611.PNG" alt="Assignment_3-nodes" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md12"></a>
How to compile and Launch the package</h1>
<h2><a class="anchor" id="autotoc_md13"></a>
Compile</h2>
<p>First you create a folder for your catkin workspace </p><div class="fragment"><div class="line">mkdir -p ~/catkin_ws/src</div>
</div><!-- fragment --><p>Clone the package repository </p><div class="fragment"><div class="line">cd ~/catkin_ws/src</div>
<div class="line">git clone https://github.com/furqan41/final_assignment.git</div>
</div><!-- fragment --><p>Once the package has been successfully cloned, you then build the workspace </p><div class="fragment"><div class="line">cd ~/catkin_ws/</div>
<div class="line">catkin_make</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md14"></a>
Launch</h2>
<p>The are two launch files to be launch, <b>simulation.launch</b> (<em>starts the already configured simulation and the movebase package</em>) and <b>final_assignment.launch</b> (<em>starts the movebase client and the bug0 launch file which contains go to point and wall follow nodes</em>).</p>
<p>Step one, source the setup.bash file, if you followed the steps above, then you can enter the command below. </p><div class="fragment"><div class="line">source ~/catkin_ws/devel/setup.bash</div>
</div><!-- fragment --><p>If you didnt follow the initial steps because you already have a workspace, trace a path from you home directory to your catkin workspace down to your setup.bash file. An Example is shown below, <b><em>THIS WILL NOT WORK FOR YOU, IT IS JUST AN EXAMPLE TO SHOW HOW IT CAN BE DONE</em></b> </p><div class="fragment"><div class="line">source /home/root/Desktop/catkin_ws/devel/setup.bash</div>
</div><!-- fragment --><p>run the command below to launch the simulation <em>you might see some warning messages <b>IGNORE THEM</b></em> </p><div class="fragment"><div class="line">roslaunch final_assignment simulation.launch </div>
</div><!-- fragment --><p>run the command below to start all the nodes required for the robot control </p><div class="fragment"><div class="line">roslaunch final_assignment final_assignment.launch </div>
</div><!-- fragment --><p>run the command below to start the user interface node </p><div class="fragment"><div class="line">rosrun final_assignment user_interface.py</div>
</div><!-- fragment --><p>from here, follow the instructions given on the command line prompt </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
